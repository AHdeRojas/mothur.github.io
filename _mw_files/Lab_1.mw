The first lab of the workshop will cover some methods that you might choose to use to quickly analyze your 16S rRNA gene sequences to determine "who they are".  For this workshop you need to download and open [[Media:ClassificationData.zip | ClassificationData.zip]].  These are 16S rRNA gene sequences  generated in the Schloss lab from the gut of a ''Tribolium castaneum'' larva.  Your job in this lab is to determine, using databases, the closest relative to these sequences.  In [[costello stool analysis | lab 2]] we will use mothur to characterize pyrosequencing data in mothur


__TOC__

==GenBank==
Blast (Basic Local Alignment Search Tool) is a very popular and often misused tool to identify similar DNA fragments/protein sequences.  Remember that BLAST searches for the best '''local alignment''' of your sequence to the database.  So although you may submit a 1-kb sequence, it may only align 500 bp.  If the sequence is 97% similar over the most similar 500-bp region, think about what this might mean over the full length of the DNA fragment.  Rarely will you see BLAST used to do anything (in reputable journals) but a quick screen of phylum-level assignment.  There are several flavors of BLAST.  For analyzing 16S rRNA genes, you want to use blastn.  This sub-program compares a DNA sequence to a database of DNA sequences.  Naturally, blast against the nt database will be based on the NCBI taxonomy, which is a bit inadequate.


So you too can have a blast with this tool, point your internet browser to [http://blast.ncbi.nlm.nih.gov/Blast.cgi?PAGE=Nucleotides&PROGRAM=blastn&MEGABLAST=on&BLAST_PROGRAMS=megaBlast&PAGE_TYPE=BlastSearch&SHOW_DEFAULTS=on&LINK_LOC=blasthome NCBI's blastn server].  
After you have opened your sequences in a text editor, copy and paste the first sequence into the window where it says "Enter Query Sequence".  Next, look at the "Database" field.  By default this is set to blast against the "Human genomic plus transcript (Human G+T)" database.  This is not what you want.  Using the drop down menu, change the database to "Nucleotide collection (nr/nt)".  Finally, press the "BLAST" button.  Depending on the volume of searches going on, this may take 15 seconds or it may take a few minutes.  A common pastime is to hit the refresh buttons repeatedly until the report screen pops up.  A perhaps more productive use of your time would be to open multiple tabs in your browser and run concurrent searches.  Once you get the report, investigate the alignment, % similarity, top 10 (or 50) closest matches, length of alignment, etc.  You should also look at the "flat file" (If you click on the accession number of a sequence, the page it brings you to is the flat file) for the most similar sequence to yours and look at its Taxonomy record.

==RDP==
The [http://rdp.cme.msu.edu Ribosomal Database Project (RDP)] is located at Michigan State University and has a number of useful tools for analyzing sequences, generating alignments, designing FISH probes/PCR primers, analyzing T-RFLP data, and other useful features.  Browse around their website and see what they offer.  You can find a number of useful videos that teach how to use the resources available on the website.  We are interested in using the [http://rdp.cme.msu.edu/classifier/classifier.jsp RDP Classifier] to analyze our sequences.  This tool uses a Bayesian analysis based on using kmer counts to assign sequences to phylogenetic groupings.  This classifier is trained on a dataset of sequences using Bergey's Taxonomy.  Although this is the standard, it tends to have a large number of "unclassified" groups.

Go ahead and enter your sequences into the window and press the "Submit" button.  This will generate a tree-like diagram showing the relative confidence that your sequence belongs to each group.  Again, explore the output and compare it the results from your blastn analysis

==greengenes==
The [http://greengenes.lbl.gov/cgi-bin/nph-index.cgi greengenes] database is similar to the RDP in many respects, but very different.  Whereas the RDP tries to keep track of every 16S rRNA gene sequence, the folks at greengenes focus on those sequences longer than 1.2 kb.  Also, greengenes places a lot of emphasis on aligning sequences so that you can import the sequences into ARB for subsequent analyses.  greengenes provides three methods that directly help you to classify your sequences: blast, simrank, and an alignment-based approach.  A nice feature of the greengenes site is the ability to choose between the Hugenholtz (default), Pace, Ludwig (arb), NCBI, and RDP taxonomies.  Within each of the three available methods there are many different options.  Once you go through them using the defaults, I encourage you to go back through the tools and play with the settings to see what makes the most sense.

===blast===
As implemented within greengenes, the blast option compares your sequences against the greengenes database and is optimized to find longer matches than the default settings on the NCBI server.  Go ahead and copy and paste your sequence into the input window and press the "Begin BLAST" button.  Again, depending on the level of usage, this will take varying lengths of time.  The output is different from the NCBI site.  greengenes provides a tree-like output indicating the level of similarity between your sequence and those in the database.

===Simrank===
Simrank counts the number of "words" that are 7 letters long in your sequence and compares those words to what is found in the database.  Clearly, the more words two sequences hold in common, you would expect the sequences to be more similar to each other.  Pressing the "Begin Simrank" button provides a very similar output to that provided via greengenes implementation of blast.

===Aligned sequences===
In this classification method, greengenes essentially builds a tree using your sequence and reports the most similar sequences.  First,  you need to generate an alignment that is compatible with the greengenes alignment, which was the original arb alignment.  Click on the "Align" button on the top of the page.  Use the radio buttons to upload a file containing any or all of your sequences.  For this example, decrease the minimum sequence length to 500.  Scroll to the bottom of the page, enter your email address, and press the "Process Fasta File" button.  Wait a few minutes and you should receive an email with your aligned sequences.

Once this file is delivered, copy it to your desktop and decompress it.  One of the files will be a "fasta-formatted" alignment.  Open this in a text editor to just see that it looks right.  Then press the "Compare" button on the top of the page and return to the "Aligned" page.  Press the "Choose File" radio button to upload your fasta file, enter your email address, and hit the "Classify Batch" button.  Again, after waiting a bit you should get an email containing the results of the analysis.


==Chimera==
SequenceC is actually a chimera of Sequences A and B.  Thinking back over your results from these various steps, how could you have anticipated this?